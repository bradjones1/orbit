---
title: What's new in v0.17
---

This is a distillation of what's new in Orbit v0.17, intended as a reference for developers who need to upgrade their apps and libraries from v0.16.

## New Site + API Reference

v0.17 is Orbit's first release that comes with [API docs](./api/index.md) for
all its packages. These docs are generated by [TypeDoc](https://typedoc.org/)
from Orbit's typings and code annotations. Although a bit sparse for now, this
reference should only improve with time and help from the community.
Contributions will be most appreciated!

## Improved, strict typings throughout

The TypeScript in all of Orbit's packages has been improved to the extent that
it is now all compiled with the
[strict](https://www.typescriptlang.org/tsconfig#strict) flag. This has allowed
us to refactor more confidently, improve our documentation, and provide a
better developer experience all around.

## Extraction of `@orbit/records` from `@orbit/data`

As part of the push to improve typings, it became clear that
[`@orbit/data`](./api/data/index.md) contains a number of interfaces and classes
that could prove useful for _any_ type of data, not just records. Thus,
record-specific types and classes were extracted into a new package:
[`@orbit/records`](./api/records/index.md).

Please review the [exports](./api/records/modules.md) from `@orbit/records` for
a complete listing of classes, interfaces, and other types that have been moved
to this new package.

Be aware that several exports have been renamed to be explicit about being
record-specific. For instance, `Schema` is now `RecordSchema`, so you'll want to
make this refactor:

```diff
- import { Schema } from '@orbit/data';
+ import { RecordSchema } from '@orbit/records';
```

Apologies for this breaking change and the refactoring it requires. We're trying
to get the scope of each package settled prior to v1.0.

:::caution Breaking change

Please review all your direct imports from `@orbit/data` and replace them as
needed with imports from `@orbit/records`.

:::

## Singular vs. multi-expression queries

In v0.16, each `Query` could only have a single `expression`:

```typescript
// v0.16
export interface Query {
  id: string;
  expression: QueryExpression;
  options?: any;
}
```

Now, [`Query`](./api/data/interfaces/Query.md) is typed as follows, with
`expressions` that can be singular or an array of query expressions:

```typescript
// v0.17
export interface Query<QE extends QueryExpression> {
  id: string;
  expressions: QE | QE[];
  options?: RequestOptions;
}
```

This allows sources, such as `JSONAPISource`, to optionally perform these
expressions in parallel, which it does now by default.

Now that queries can contain multiple expressions just like transforms can
contain multiple operations, there needs to be a clear and consistent way to
build them. And likewise, the expectation needs to be clear about the form
or results that need to be returned.

Here's a single expression to a query builder, which can be expected to return
a single result:

```typescript
const earth = source.query((q) =>
  q.findRecord({ type: 'planet', id: 'earth' })
);
```

That same expression could be passed in an array, which will cause results to be
returned in an array:

```typescript
const [earth] = source.query((q) => [
  q.findRecord({ type: 'planet', id: 'earth' })
]);
```

And of course, that array could be expanded to include more than one expression:

```typescript
const [earth, jupiter, saturn] = source.query((q) => [
  q.findRecord({ type: 'planet', id: 'earth' }),
  q.findRecord({ type: 'planet', id: 'jupiter' }),
  q.findRecord({ type: 'planet', id: 'saturn' })
]);
```

As mentioned above, this query may be handled with 3 parallel requests, but will
only resolve when all have completed successfully.

:::caution Breaking change

Although most developers typically do not interact with queries directly, if
you do it's important to note the change from `expression` -> `expressions`.

:::

## Singular vs. multi-operation transforms

All the patterns mentioned above for queries also apply to transforms.

A single operation provided to a transform builder will return a single result:

```typescript
const earth = source.update((t) =>
  t.adddRecord({ type: 'planet', id: 'earth' })
);
```

The same expression passed in an array will cause results to be returned in an
array:

```typescript
const [earth] = source.update((t) => [
  t.adddRecord({ type: 'planet', id: 'earth' })
]);
```

And as before, multi-operation transforms will produce an array of results:

```typescript
const [earth, jupiter, saturn] = source.update((t) => [
  t.adddRecord({ type: 'planet', id: 'earth' }),
  t.adddRecord({ type: 'planet', id: 'jupiter' }),
  t.adddRecord({ type: 'planet', id: 'saturn' })
]);
```

The [`Transform`](./api/data/interfaces/Transform.md) interface has changed
subtly such that `operations` can now be singular or an array, to parallel
`Query#expressions`:

```typescript
// v0.17
export interface Transform<O extends Operation> {
  id: string;
  operations: O | O[];
  options?: RequestOptions;
}
```

:::caution Breaking changes

The change that allows `Transform`'s `operations` to be singular is breaking.
You may wish to use a utility function such as
[`toArray`](./api/utils/modules.md#toarray) to interact with `operations`
uniformly as an array.

Also note that, in v0.16, calling `update` with a single operation in an array
would return a singular result. It will now return that same result as the
single member of an array.

:::

## Full vs. data-only responses

All requests (queries and updates) can now be made with the `{ fullResponse:
true }` option to receive responses in the form `{ data, details, transforms,
sources }`. `data` will include the primary data that would be returned without
the `fullResponse` option. `details` includes response details particular to the
source, and `sources` includes a named map of all the responses from downstream
sources that participated in this request. This allows you to access full
response documents, inverse operations, etc. _from the initial request call
point_.

***TODO: This document is a WIP***